<link rel="stylesheet" type="text/css" href="style.css">


<table id='header'>
<tr>
	<td class='icon'>
		<img src='icon.png'/>
	</td>
	<td class='brand'>
		snip.yt
	</td>
	<td class='search'>
		<input type='search' placeholder="search..." />
	</td>
	<td class='settings'></td>
</tr>
</table>

<div id='list'></div>



<script>
MONTHS = "Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(',');
HTML = {
	page: data => {
		data.title = data.title.split(' - ')[0].split(' â€“ ')[0].split(' | ')[0];
		var out = `<b>${data.title}</b>`;
		data.quotes.forEach(quote=>{
			out += HTML.snippet(quote);
		});
		let domain = data.URL.split('//')[1].split('/')[0].split('.').slice(-2).join('.');
		out += `<img src="http://www.google.com/s2/favicons?domain=${domain}"/>`;
		out += `<i>${domain}</i>`;
		let d = new Date(Date.parse(data.t));
		out += `<time>${d.getDate()}. ${MONTHS[d.getMonth()]} ${d.getFullYear()}</time>`;
		return `<div>${out}</div>`;
	},
	snippet: data => {
		// return `<q>${data.quote}</q>`;
		return `<p>${data.quote}</p>`;
	}
}

fetch('http://api.max.pub/snippets/?do=list')
	.then((response) => response.json())
	.then((snippets) => {
		console.log('snippets',snippets);
		var tmp = '';
		snippets.forEach(snippet=>{
			tmp += HTML.page(snippet);
		});
		document.getElementById('list').innerHTML = tmp;
	});

</script>